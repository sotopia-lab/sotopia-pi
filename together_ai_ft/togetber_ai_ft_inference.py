import together

model = "ruiyiwan@andrew.cmu.edu/ft-caab5314-f9a5-4a7c-960a-fec91098947a-2023-10-10-15-35-01"

prompt = "Prompt after formatting:\nImagine you are Ethan Smith, your task is to act/speak as Ethan Smith would, keeping in mind Ethan Smith's social goal.\nYou can find Ethan Smith's background and goal in the 'Here is the context of the interaction' field.\nNote that Ethan Smith's secret and goal is only visible to you.\nYou should try your best to achieve Ethan Smith's goal in a way that align with their character traits.\nAdditionally, maintaining the conversation's naturalness and realism is essential (e.g., do not repeat what other people has already said before).\n\nHere is the context of this interaction:\nScenario: Two friends are at a community gathering where one of them was giving a speech but was interrupted\nParticipants: Hendrick Heinz and Ethan Smith\nHendrick Heinz's background: Hendrick Heinz is a 54-year-old male chef. He/him pronouns. Hendrick Heinz hosts monthly wine tasting nights with his peers. Personality and values description: Hendrick Heinz, though somewhat impulsive, values hedonism and conformity. He combines practicality with decisiveness in decision-making. \nEthan Smith's background: Ethan Smith is a 29-year-old male software developer. He/him pronouns. Ethan enjoys reading about new technological advancements and watching documentaries. Personality and values description: Ethan Smith is a reserved, independent thinker. Holding universalism and fairness near, he ponders deeply before making decisions. Ethan's secrets: Secretly donates to charities for underprivileged children\nHendrick Heinz's goal: Unknown\nEthan Smith's goal: Apologize for interrupting and allow them to continue speaking (Extra information: You accidentally interrupted someone's speech and everyone seems upset about it. )\nConversation Starts:\n\nTurn #0: Hendrick Heinz said: \"Well, where was I? Ah yes, let me continue. As I was saying, sharing gourmet knowledge is not just about showing off, but rather enhancing the experience..\"\n.\nYou are at Turn #1. Your available action types are\nnone action speak non-verbal communication leave.\nNote: You can \"leave\" this conversation if 1. you have achieved your social goals, 2. this conversation makes you uncomfortable, 3. you find it uninteresting/you lose your patience, 4. or for other reasons you want to leave.\n\nPlease only generate a JSON string including the action type and the argument.\nYour action should follow the given format:\n\nAs an example, for the schema {\"properties\": {\"foo\": {\"title\": \"Foo\", \"description\": \"a list of strings\", \"type\": \"array\", \"items\": {\"type\": \"string\"}}}, \"required\": [\"foo\"]}\nthe object {\"foo\": [\"bar\", \"baz\"]} is a well-formatted instance of the schema. The object {\"properties\": {\"foo\": [\"bar\", \"baz\"]}} is not well-formatted.\n\nHere is the output schema:\n```\n{\"description\": \"An interface for messages.\\nThere is only one required method: to_natural_language\", \"properties\": {\"action_type\": {\"title\": \"Action Type\", \"description\": \"whether to speak at this turn or choose to not do anything\", \"enum\": [\"none\", \"speak\", \"non-verbal communication\", \"action\", \"leave\"], \"type\": \"string\"}, \"argument\": {\"title\": \"Argument\", \"description\": \"the utterance if choose to speak, the expression or gesture if choose non-verbal communication, or the physical action if choose action\", \"type\": \"string\"}}, \"required\": [\"action_type\", \"argument\"]}\n```\u001b[0m\n"

output = together.Complete.create(
    prompt=prompt,
    model=model,
    max_tokens=256,
    temperature=0.8,
    top_k=60,
    top_p=0.6,
    repetition_penalty=1.1,
    stop=['<human>', '\n\n']
)

print(output["output"]["choices"][0]["text"])
